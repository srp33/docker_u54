description: Calls somatic variants using Mutect2 (GATK) for a tumor/normal pair.
args:
    - FASTA_FILE:
        opts: "-r | --reference"
        description: "Name of the reference genome FASTA file."
        example: "hg19.fa"
    - TUMOR_BAM_FILE:
        opts: "-m | --tumor_bam_file"
        description: "Path to a BAM file with tumor data."
        example: "SampleA_Tumor.bam"
    - NORMAL_BAM_FILE:
        opts: "-n | --normal_bam_file"
        description: "Path to a BAM file with normal data."
        example: "SampleA_Normal.bam"
    - OUTPUT_FILE:
        opts: "-o | --output"
        description: "Name of the output VCF file."
        example: "SampleA.vcf"
    - THREADS:
        opts: "-t | --nthreads"
        description: "The number of threads that GATK should use. Default is 1."
        default: 1
        example: "4"
volumes:
    - ref_dir:
        description: "Directory where the reference genome FASTA file and indices are stored."
    - input_bam_dir:
        description: "Directory where the input BAM file is stored."
    - output_vcf_dir:
        description: "Directory where the output BAM file will be stored."
        write_access: True
command_template: |
    gatk4 Mutect2 -I /volumes/input_bam_dir/"${TUMOR_BAM_FILE}" -tumor "${TUMOR_BAM_FILE/\.bam/}" \
      -I /volumes/input_bam_dir/"${NORMAL_BAM_FILE}" \
      -normal "${NORMAL_BAM_FILE/\.bam/}" \
      -O /volumes/output_vcf_dir/"${OUTPUT_FILE}" \
      -R /volumes/ref_dir/"${FASTA_FILE}" \
      --nativePairHmmThreads $THREADS
receipt_commands: |
    get_bash_version
    get_conda_version gatk4